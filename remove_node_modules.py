import os
import time
import shutil


def remove_node_modules(dirpath):
    ndir = 0
    ndir_removed = 0
    for root, dirs, files in os.walk(dirpath):
        print('Dir number: ' + str(ndir) + ' (' + root + ')')

        for name in dirs:
            if name == 'node_modules':
                dir_to_remove = os.path.join(root, name)
                print('>> Remove: ', dir_to_remove)

                shutil.rmtree(dir_to_remove, ignore_errors=True)
                ndir_removed = ndir_removed + 1
        ndir = ndir + 1

    print('\n\nDirs removed:' + str(ndir_removed))


if __name__ == "__main__":
    ti = time.process_time()

    remove_node_modules(r'/home/heitor/projects')

    tf_sec = int((time.process_time() - ti) % 60)
    tf_min = int((tf_sec / 60) % 60)
    tf_h = int((tf_min / 60) % 24)
    print('Done in {} hours {} minutes {} seconds!'.format(tf_h, tf_min, tf_sec))
